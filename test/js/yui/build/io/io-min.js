/*
Copyright (c) 2008, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 3.0.0pr2
*/
YUI.add("io-base",function(D){E_START="io:start",E_COMPLETE="io:complete",E_SUCCESS="io:success",E_FAILURE="io:failure",E_ABORT="io:abort",transactionId=0,_headers={"X-Requested-With":"XMLHttpRequest"},_timeout={},_q=[],_qState=1,_qMaxSize=false,w=D.config.win;function J(Y,e){if(_qMaxSize===false||_q.length<_qMaxSize){var d=F();_q.push({uri:Y,id:d,cfg:e});}else{return false;}if(_qState===1){N();}return d;}function G(f){var d;for(var Y=0;Y<_q.length;Y++){if(_q[Y].id===f){d=_q.splice(Y,1);var e=_q.unshift(d[0]);break;}}}function N(){var Y=_q.shift();b(Y.uri,Y.cfg,Y.id);}function H(Y){if(Y){_qMaxSize=Y;return Y;}else{return _q.length;}}function V(){var Y=(_q.length>_qMaxSize>0)?_qMaxSize:_q.length;if(Y>1){for(var d=0;d<Y;d++){N();}}else{N();}}function K(){_qState=0;}function C(d){if(D.Lang.isNumber(d)){for(var Y=0;Y<_q.length;Y++){if(_q[Y].id===d){_q.splice(Y,1);break;}}}}function b(g,l){var l=l||{},k=Z((arguments.length===3)?arguments[2]:null,l),Y=(l.method)?l.method.toUpperCase():"GET",j=(l.data)?l.data:null,h;if(l.form){if(l.form.upload){u=D.io._upload(k,g,l);return u;}h=D.io._serialize(l.form);if(j){h+="&"+j;}if(Y==="POST"){j=h;X("Content-Type","application/x-www-form-urlencoded");}else{if(Y==="GET"){g=Q(g,h);}}}else{if(j&&Y==="GET"){g=Q(g,l.data);}else{if(j&&Y==="POST"){X("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");}}}if(l.xdr){D.io._xdr(g,k,l);return k;}if(l.timeout){R(k,l);}k.c.onreadystatechange=function(){c(k,l);};try{E(k.c,Y,g);}catch(i){}B(k.c,(l.headers||{}));k.abort=function(){S(k,l);};k.isInProgress=function(){return k.c.readyState!==4&&k.c.readyState!==0;};W(k,(j||""),l);return k;}function A(d,f){var Y=new D.Event.Target().publish("transaction:"+d);Y.subscribe(f.on[d],(f.context||this),f.arguments);return Y;}function T(g,f){f.on=f.on||{};var Y=D.io._fn||{},d=(Y&&Y[g])?Y[g]:null,e;if(d){f.on.start=d.start;delete d;}D.fire(E_START,g);if(f.on.start){e=A("start",f);e.fire(g);}}function I(d,e){e.on=e.on||{};var Y;D.fire(E_COMPLETE,d.id,d.c);if(e.on.complete){Y=A("complete",e);Y.fire(d.id,d.c);}}function U(f,g){g.on=g.on||{};var Y=D.io._fn||{},d=(Y&&Y[f.id])?Y[f.id]:null,e;if(d){g.on.success=d.success;delete d;f.c.responseText=decodeURI(f.c.responseText);}D.fire(E_SUCCESS,f.id,f.c);if(g.on.success){e=A("success",g);e.fire(f.id,f.c);}L(f,(g.xdr)?true:false);}function M(f,g){g.on=g.on||{};var Y=D.io._fn||{},d=(Y&&Y[f.id])?Y[f.id]:null,e;if(d){g.on.failure=d.failure;delete d;f.c.responseText=decodeURI(f.c.responseText);}D.fire(E_FAILURE,f.id,f.c);if(g.on.failure){e=A("failure",g);e.fire(f.id,f.c);}L(f,(g.xdr)?true:false);}function S(f,g){g.on=g.on||{};var Y=D.io._fn||{},d=(Y&&Y[f.id])?Y[f.id]:null,e;if(f&&f.c&&!g.xdr){f.c.abort();if(g){if(g.timeout){P(f.id);}}}if(d){g.on.abort=d.abort;delete d;}D.fire(E_ABORT,f.id);if(g.on.abort){e=A("abort",g);e.fire(id);}L(f,(g.xdr)?true:false);}function F(){var Y=transactionId;transactionId++;return Y;}function Z(Y,e){var d={};d.id=D.Lang.isNumber(Y)?Y:F();if(e.xdr){d.c=D.io._transport[e.xdr.use];}else{if(e.form&&e.form.upload){d.c={};}else{d.c=O();}}return d;}function O(){return(w.XMLHttpRequest)?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");}function Q(Y,e){Y+=((Y.indexOf("?")==-1)?"?":"&")+e;return Y;}function X(Y,d){if(d){_headers[Y]=d;}else{delete _headers[Y];}}function B(e,Y){var d;for(d in _headers){if(_headers.hasOwnProperty(d)){Y[d]=_headers[d];}}for(d in Y){if(Y.hasOwnProperty(d)){e.setRequestHeader(d,Y[d]);}}}function E(e,Y,d){e.open(Y,d,true);}function W(e,Y,f){e.c.send(Y);T(e.id,f);}function R(Y,d){_timeout[Y.id]=w.setTimeout(function(){S(Y,d);},d.timeout);}function P(Y){w.clearTimeout(_timeout[Y]);delete _timeout[Y];}function c(Y,d){if(Y.c.readyState===4){if(d.timeout){P(Y.id);}I(Y,d);a(Y,d);}}function a(f,g){var Y;try{if(f.c.status&&f.c.status!==0){Y=f.c.status;}else{Y=0;}}catch(d){Y=0;}if(Y>=200&&Y<300||Y===1223){w.setTimeout(function(){U(f,g);},0);}else{w.setTimeout(function(){M(f,g);},0);}}function L(d,Y){if(w.XMLHttpRequest&&!Y){if(d.c){d.c.onreadystatechange=null;}}d.c=null;d=null;}b.start=T;b.complete=I;b.success=U;b.failure=M;b.abort=S;b.timeout=_timeout;b.header=X;b.queue=J;b.queue.size=H;b.queue.start=V;b.queue.stop=K;b.queue.promote=G;b.queue.purge=C;D.io=b;},"3.0.0pr2");YUI.add("io-form",function(A){A.mix(A.io,{_serialize:function(C){var I=(typeof C.id==="object")?C.id:A.config.doc.getElementById(C.id),H=encodeURIComponent,G=[],L=C.useDisabled||false,O=0,J,D,M,K,F,B,E,N,C;for(F=0,B=I.elements.length;F<B;++F){J=I.elements[F];K=J.disabled;D=J.name;if((L)?D:(D&&!K)){D=encodeURIComponent(D)+"=";M=encodeURIComponent(J.value);switch(J.type){case"select-one":if(J.selectedIndex>-1){C=J.options[J.selectedIndex];G[O++]=D+H((C.attributes.value&&C.attributes.value.specified)?C.value:C.text);}break;case"select-multiple":if(J.selectedIndex>-1){for(E=J.selectedIndex,N=J.options.length;E<N;++E){C=J.options[E];if(C.selected){G[O++]=D+H((C.attributes.value&&opt.attributes.value.specified)?C.value:C.text);}}}break;case"radio":case"checkbox":if(J.checked){G[O++]=D+M;}break;case"file":case undefined:case"reset":case"button":break;case"submit":break;default:G[O++]=D+M;}}}return G.join("&");}},true);},"3.0.0pr2",{requires:["io-base"]});YUI.add("io-xdr",function(C){var A="io:xdrReady";function B(E,F){var D='<object id="yuiSwfIo" type="application/x-shockwave-flash" data="'+E+'" width="0" height="0">'+'<param name="movie" value="'+E+'">'+'<param name="FlashVars" value="yid='+F+'">'+'<param name="allowScriptAccess" value="sameDomain">'+"</object>";C.get("body").appendChild(C.Node.create(D));}C.mix(C.io,{_transport:{},_fn:{},_xdr:function(D,E,F){if(F.on){this._fn[E.id]=F.on;}E.c.send(D,F,E.id);return E;},transport:function(D){switch(D.id){case"flash":B(D.src,D.yid);this._transport.flash=C.config.doc.getElementById("yuiSwfIo");break;case"upload":break;}},xdrReady:function(D){C.fire(A,D);}});},"3.0.0pr2",{requires:["io-base"]});YUI.add("io",function(A){},"3.0.0pr2",{use:["io-base","io-form","io-xdr"]});